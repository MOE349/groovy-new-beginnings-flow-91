server {

  listen 80;

  server_name localhost;
 
  root /usr/share/nginx/html;

  index index.html;
 
  # Donâ€™t hijack valid paths

  location /assets/ {

    access_log off;

    expires 1y;

    add_header Cache-Control "public";

    try_files $uri =404;

  }
 
  location /lovable-uploads/ {

    try_files $uri =404;

  }
 
  # Let React handle routing, ONLY if browser accepts HTML

  location / {

    try_files $uri $uri/ @react;

  }
 
  location @react {

    # Only fallback if browser wants HTML (not API, not .js, not JSON etc.)

    if ($http_accept !~* "text/html") {

      return 404;

    }

    rewrite ^ /index.html;

  }
 
  # Let 404 bubble up to frontend React router (custom page)

  error_page 404 /index.html;

}

 
